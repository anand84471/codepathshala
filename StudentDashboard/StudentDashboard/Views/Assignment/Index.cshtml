@{
    ViewBag.Title = "Join course";
    Layout = "~/Views/Shared/_AboutLayout.cshtml";
}
<style type="text/css">
    .custom-blue {
        background-image: linear-gradient(to right, rgba(51, 91, 255), rgba(51, 80, 210));
    }

    .custom-white {
        background-image: linear-gradient(to right, rgba(253, 254, 254), rgba(253, 254, 254));
    }

    .custom-green {
        color: white;
        background-image: linear-gradient(to right, rgba(8, 254, 58, 0.84), rgba(27, 164, 26, 0.63));
    }

    .card {
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        border-radius: 5px;
    }

        .card:hover {
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
        }

    .custom-join-button {
        background: rgb(63,94,251);
        background: radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(252,70,107,1) 100%);
    }

    .custom-color-desc {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        color: #655b5b;
    }

    .custom-dialog-header {
        background: rgb(131,58,180);
        color: turquoise;
        background: linear-gradient(90deg, rgba(131,58,180,1) 0%, rgba(253,29,29,1) 50%, rgba(252,176,69,1) 100%);
    }
</style>

<div class="container-fluid" id="addNewCourseContainer">

    <nav class="container-fluid">
        @*<a href="./Home" class="btn navbar-item text-white">
                <i class="fa fa-arrow-left"></i>
            </a>*@
        <div class="input-group ">
            <select class="input-group-prepend " style="width:70px" id="inlineFormCustomSelect">
                <option selected value="1">Filter...</option>
                <option value="1">Date of creation ascending</option>
                <option value="2">Date of creation descending</option>
                <option value="3">Popularity</option>
                <option value="4">Rating</option>
                @*<option value="php">Price high to low</option>
                    <option value="plh">Price low to high</option>*@
            </select>
            <input type="text" class="form-control" id="assignmentSearchBox" placeholder="Search for assignment..." aria-label="Search">
            <div class="input-group-append">
                <button class="btn btn-primary" onclick="searchForAssignment()" type="button">
                    <i class="icon-search"></i>
                </button>
            </div>
        </div>
    </nav>
    <div class="row">
        <div class="text-center ml-3">

            <hr class="mb-3" />
        </div>
        <div class="col p-1">
            <div class="alert alert-danger p-2 m-3" role="alert" style="display:none" id="noassignmentsFound">
                <h4 class="alert-heading">No assignments found.</h4>
            </div>
            <div class="row pl-1" id="assignmentsContainer">
                <div class="text-center container-fluid" id="searcBoxImage">
                    <h1 class="text-center center">Search for assignments</h1>
                    <img src="~/Images/content-search.svg" class="img-fluid" style="width:300px;height:300px;" />
                </div>
            </div>
            <div class="col-sm-12" id="showMoreassignmentButton" style="display:none">
                <button class="btn btn-block btn-outline-primary" onclick="searchForAssignment()">Load more</button>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
        'use strict';
        var input = document.getElementById("assignmentSearchBox");
        input.addEventListener("keyup", function (event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                searchForAssignment();
            }
        });
        $("#assignmentMenu").addClass("active");
        $("#homeMenu").removeClass("active");
        onpageshow = searchForAssignment();
    })();
    var lastassignmentIdFetched = 0;
    function searchForAssignment()
    {
        $("#noassignmentsFound").hide();
        var _data =
            {
                "search_string": $("#assignmentSearchBox").val(),
                "last_feched_content_id": lastassignmentIdFetched,
            }
        $.ajax({
            type: "POST",
            data: JSON.stringify(_data),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            url: "/api/v1/document/FetchFeeAssignments",
            success: function (data) {
                debugger;
                if (data != null && data.response_code == 1 && data.assignments != null) {
                    var assignments = data.assignments;
                    var coursesContainer = $("#assignmentsContainer");
                    $("#searcBoxImage").remove();
                    if (assignments.length == 10)
                    {
                        $("#showMoreassignmentButton").show();
                    }
                    else {
                        $("#showMoreassignmentButton").hide();
                    }

                    for (var i = 0; i < assignments.length;i++)
                    {
                        if (assignments[i].name.length > 15) {
                            assignments[i].name = assignments[i].name.substring(0, 15) + "...";
                        }
                        if (assignments[i].description.length > 28) {
                            assignments[i].description = assignments[i].description.substring(0, 28) + "...";
                        }
                        lastassignmentIdFetched = assignments[i].assignment_id;
                       var rows=('<div class="col-xl-4 col-md-6 mb-4">'
                    + '<div class="card border-primary  ml-2 mr-2 mb-2">'
                    + '<div class="card-header custom-green">'
                    + '<h4 class="font-weight-bold"><a>' + assignments[i].name + '</a></h4>'
                    +'</div>'
                    +'<div class="card-body text-center">'

                        + '<h6 class="custom-color-desc font-weight-bold">' + assignments[i].description + '</h6>'
                         + '<h6 class="text-mutated font-weight-bold">' + assignments[i].creation_date + ' | FREE</h6>'
                         + ' <p class="text mr-3"><i class="fa fa-users mr-2"></i><b>Submissions:</b> ' + assignments[i].no_of_submissions + '</p>'
                          //+ ' <p class="text mr-3"><b>Author:</b> ' + assignments[i].instructor_name + '</p>'
                        +'<ul class="list-unstyled list-inline rating mb-0">'
                            + '<li class="list-inline-item mr-0"><a  class="btn lg btn-primary custom-join-button"  href="assignment/Details?id=' + assignments[i].assignment_id + '&access_code=' + assignments[i].access_code + '">Prcitce Now</a></li>'
                        +'</ul>'
                    +'</div>'
                +'</div>'
            + '</div>');
                       coursesContainer.append(rows);
                    }
                }
                else {
                    $("#noassignmentsFound").show();
                }
            }
        });
    }
</script>
